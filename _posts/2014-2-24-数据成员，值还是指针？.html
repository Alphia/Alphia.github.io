---
   title: 数据成员，值还是指针？
   keyword: 数据成员，定义方式
   layout: blog
---



首先定义问题：
在c++中，对于一个类，其数据成员的类型是类类型，那么该数据成员应该被定义为以下哪种方式？ 使用哪种方式，为什么？
{% highlight c++ %}
Class XX{
    A *a = new A();      // 定义为指针  .......①
    A a;                       // 定义为对象  .......②
}
{% endhighlight %}

我认同这两种方式各自有优点，取决于具体情况。

指针相对于值的区别：
1. 延迟初始化 / lazy initialization
2. 减少头文件依赖 / less header dependency
3. 指针指向的对象，生命周期有了更大的灵活性 / more control about livetime
4. 多态 / polymophic
5. 共享对象或对象重新申请空间。/ shared or reallocation

不难发现，指针可以做到值很难做或者做不到的事情，但指针有自身的问题，就是需要额外处理关于具体内存空间的问题。

在我看来，除非需要，一般使用值的方式定义数据成员，两个原因：
1. 集中注意力在有业务价值的问题上，而非认为引入问题
2. 减少出错的机会。
